<div ng-controller="messageDetailCtrl">
    <!-- header -->
    <div class="wrapper bg-light lter b-b current_dialogue">
        <div class="text-center">当前对话 {{$stateParams.receiverName}}</div>
        <a class="refresh" ng-click="refreshMessages()" title="点击刷新"><i class="icon-refresh"></i></a>
    </div>
    <!-- / header -->


    <!-- list -->
    <div class="mail-top">
        <div class="bg-light lter">
            <div>
                <div class="text-center"><a href="#" class="text-muted">加载更多</a></div>

                <ul id="scrolldIV"
                    class="list-group list-group-lg no-radius m-b-none m-t-n-xxs mail-list-hei mail-list-win">
                    <li ng-repeat="mail in currenttalk" ng-class="mail.sender._id==curUser._id&&'transfer'"
                        class="list-group-item clearfix b-l-3x">
                        <a class="avatar thumb pull-left m-r">
                            <img ng-src='http://120.76.228.172:2000/person/personPic?pid={{(mail.sender==curUser._id)?mail.receiver._id:mail.sender}}'/>
                        </a>

                        <div class="text-center time">
                            <span>{{mail.create_date}}</span>
                        </div>
                        <div class="clear mail-receiver">
                            <p>
                                <a>
                                    <span ng-if="mail.text">{{mail.text}}</span>
                                    <img ng-src={{'http://120.76.228.172:2000/'+mail.image}} ng-if="mail.image"/>
                                    <video ng-if="mail.voice" id="infomedia" width='100%' height="auto" controls ng-src="{{'http://120.76.228.172:2000/'+mail.voice}}">
                                    </video>
                                </a>
                                <!--<span class="label bg-light m-l-sm" ng-hide="mail.transfer">{{mail.state=='unread'?'未读':'已读'}}</span>-->
                            </p>
                            <!--<div class="text-ellipsis m-t-xs">{{mail.content | limitTo:100}}</div>-->
                        </div>
                    </li>
                </ul>
            </div>
        </div>
    </div>

    <!-- / list -->


    <!--发送消息框-->


    <div class="wrapper-md">
        <form>
            <div class="emoji btn-group">
                <div class="list-icon btn btn-group-sm btn-file" ngf-select="uploadImageFile($file, $invalidFiles)" accept="image/*"  ngf-max-size="10MB">
                    <i class="icon-picture"></i>
                </div>
                <div class="list-icon btn btn-group-sm btn-file" ngf-select="uploadVideoFile($file, $invalidFiles)" accept="video/*"  ngf-max-size="50MB">
                    <i class="icon-camcorder"></i>
                </div>
            </div>
            <div class="send_massage" contenteditable>
                <textarea class="form-control" ng-model="unSendMessage.text" rows="5">
                </textarea>
            </div>
            <input type="button" class="action-con btn btn-danger" ng-show="(unSendMessage.text && unSendMessage.text != '')||(unSendMessage.video && unSendMessage.video != '')||(unSendMessage.image && unSendMessage.image != '')||(unSendMessage.voice && unSendMessage.voice != '')" ng-click="sendMessage()" value="发送"/>
        </form>
    </div>
</div>